/*! For license information please see index.js.LICENSE.txt */
!function(e,s){"object"==typeof exports&&"object"==typeof module?module.exports=s(require("@ant-design/icons"),require("antd"),require("react")):"function"==typeof define&&define.amd?define(["@ant-design/icons","antd","react"],s):"object"==typeof exports?exports.editor=s(require("@ant-design/icons"),require("antd"),require("react")):e.editor=s(e["@ant-design/icons"],e.antd,e.react)}(self,((e,s,t)=>(()=>{var r={961:(e,s,t)=>{"use strict";t.r(s)},335:(e,s,t)=>{"use strict";var r=t(155),l=Symbol.for("react.element"),n=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function u(e,s,t){var r,n={},u=null,c=null;for(r in void 0!==t&&(u=""+t),void 0!==s.key&&(u=""+s.key),void 0!==s.ref&&(c=s.ref),s)a.call(s,r)&&!o.hasOwnProperty(r)&&(n[r]=s[r]);if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===n[r]&&(n[r]=s[r]);return{$$typeof:l,type:e,key:u,ref:c,props:n,_owner:i.current}}s.Fragment=n,s.jsx=u,s.jsxs=u},85:(e,s,t)=>{"use strict";e.exports=t(335)},780:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.FactsEditor=s.ICRulesEditor=void 0;const r=t(85),l=t(155),n=t(783),a=t(741);t(961);let i=null;const o=({facts:e={},rule:s=["","eq",""],onUpdate:t=((e,s)=>{}),index:o=0,depth:u=0})=>{const[c]=(0,l.useState)(Object.keys(e)),[d,p]=(0,l.useState)(s),[f,h,x]=d,g=`${o}-${u}`,y=`${c}-${g}`;(0,l.useEffect)((()=>{t([f,h,x],o)}),[f,h,x]);const v=`value-${g}`,j=`term-${g}`,m=(0,a.processRuleOrGroup)(e,d);return(0,r.jsxs)("div",{className:"rule-editor",children:[(0,r.jsx)("div",{className:"rule-result",children:m.pass?(0,r.jsx)("span",{className:"pass",children:"✓"}):(0,r.jsx)("span",{className:"fail",children:"✕"})}),(0,r.jsxs)("div",{className:"rule-entry rule-fact",children:[(0,r.jsx)("input",{id:j,autoComplete:"on",autoFocus:i===j,type:"text",list:y,value:f,onChange:e=>{i=e.target.id,p([e.target.value,h,x])}}),(0,r.jsx)("datalist",{id:y,children:c.map((e=>(0,r.jsx)("option",{value:e})))})]},"rule-fact"),(0,r.jsx)("div",{className:"rule-entry rule-op",children:(0,r.jsx)("select",{value:h,onChange:e=>p([f,e.target.value,x]),children:a.operators.map((e=>(0,r.jsx)("option",{value:e,children:n.opMap[e]})))})},"rule-op"),(0,r.jsx)("div",{className:"rule-entry rule-term",children:(0,r.jsx)("input",{type:"text",id:v,value:x,autoFocus:i===v,onChange:e=>{i=e.target.id,p([f,h,e.target.value])}})},"rule-term")]},g)},u=({facts:e={},rules:t={},onChange:n=(e=>{}),depth:i=0,index:c=0,showFactsEditor:d=!0})=>{const[p,f]=(0,l.useState)(e),[h,x]=(0,l.useState)(t.all?"all":"any"),[g,y]=(0,l.useState)(t),[v,j]=(0,l.useState)([...g.all||g.any]),[m,C]=(0,l.useState)({}),b=["","eq",""],E={all:[b]},S=(e,s)=>{v[s]=e,n({[h]:[...v]},s,c)},R=e=>{v.splice(e,1),y({[h]:[...v]}),j([...v]),n({[h]:[...v]},e,c)};(0,l.useEffect)((()=>{(0,a.processVerbose)(e,g),n(g,0,c)}),[JSON.stringify(g)]),(0,l.useEffect)((()=>{y({[h]:[...v]})}),[JSON.stringify(v)]),(0,l.useEffect)((()=>{y({[h]:[...v]})}),[h]);const O=(0,a.processRuleOrGroup)(e,g);return(0,r.jsxs)("div",{className:"rule-group-editor",children:[d&&0===i&&0===c&&(0,r.jsx)("div",{children:(0,r.jsx)(s.FactsEditor,{object:p,onChange:(e,s)=>{s&&f(e)}})}),(0,r.jsxs)("div",{children:[0===i&&0===c&&(0,r.jsxs)("div",{className:"facts-status",children:[(0,r.jsxs)("span",{style:{color:O?"green":"darkred"},children:["Rule is ",O?"valid":"invalid",". "]}),(0,r.jsxs)("span",{style:{color:O?.pass?"green":"darkred"},children:["Rule is ",O?.pass?"passing":"failing",". "]})]}),(0,r.jsxs)("div",{className:"rules",children:[(0,r.jsxs)("div",{className:"rule-entry quantifier",children:[(0,r.jsx)("div",{className:"check-mark",children:O?.pass?(0,r.jsx)("span",{className:"pass",children:"☑"}):(0,r.jsx)("span",{className:"fail",children:"☒"})}),(0,r.jsx)("select",{value:h,onChange:e=>x(e.target.value),children:["all","any"].map((e=>(0,r.jsx)("option",{value:e,children:e})))}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{className:"add-group",title:"add a group",onClick:()=>((e=null)=>{null===e?v.push(E):v.splice(e,0,E),j([...v]),n({[h]:[...v]},e,c)})(),children:"➕"})})]}),(0,r.jsx)("div",{className:"rule-list",children:v.map(((s,t)=>Array.isArray(s)?(0,r.jsxs)("div",{className:"editor-wrap",children:[(0,r.jsx)(o,{onUpdate:S,rule:s,facts:p,index:t,depth:i},`${JSON.stringify(s)}-${t}-${i}`),(0,r.jsxs)("div",{className:"addrule",children:[(0,r.jsx)("button",{title:"add a rule",onClick:()=>((e=null)=>{null===e?v.push(b):v.splice(e,0,b),j([...v]),n({[h]:[...v]},e,c)})(t+1),children:"+"}),t>0&&(0,r.jsx)("button",{title:"remove rule",onClick:()=>R(t),children:"-"})]})]}):(0,r.jsxs)("div",{className:"editor-wrap",children:[(0,r.jsx)(u,{rules:s,facts:e,index:t,depth:i+1,onChange:(e,s,r)=>{v[t]=e,n({[h]:[...v]},s,r)}},`${JSON.stringify(s)}-${t}-${i}`),(0,r.jsx)("div",{className:"remove-group-cell",children:t>0&&(0,r.jsx)("button",{className:"remove-group",title:"remove group",onClick:()=>R(t),children:"➖"})})]})))})]})]})]},`group-edit-${c}-${i}`)};s.ICRulesEditor=({rules:e={},facts:s={},onChange:t=(e=>null),options:n={showFactsEditor:!0}})=>{const[a,i]=(0,l.useState)(e),{showFactsEditor:o}=n;return(0,r.jsx)(u,{rules:a,facts:s,onChange:e=>{t(e),i({...e})},showFactsEditor:o})},s.FactsEditor=({object:e,onChange:s=(()=>null)})=>{const[t,a]=(0,l.useState)(JSON.stringify(e,null,2)),i=(0,n.safeParse)(t);return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"facts-status",style:{color:i?"green":"darkred"},children:["Facts are ",i?"valid":"invalid"]}),(0,r.jsx)("textarea",{title:"enter your facts here",onChange:e=>{a(e.target.value),s(e.target.value,!1!==i)},style:{width:"300px",height:"300px"},value:t})]})},s.default=s.ICRulesEditor},69:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ICRulesEditorAntd=s.RuleEditorAntd=s.FactsEditorAntd=void 0;const r=t(85),l=t(741),n=t(155),a=t(783),i=t(59),o=t(375);t(961);let u=null;s.FactsEditorAntd=({object:e,onChange:s=(()=>null)})=>{const[t,l]=(0,n.useState)(JSON.stringify(e,null,2)),o=(0,a.safeParse)(t);return(0,r.jsx)(i.Card,{style:{width:"350px",margin:"4px"},hoverable:!0,title:(0,r.jsxs)("span",{style:{color:o?"green":"darkred"},children:["Facts are ",o?"valid":"invalid","."]}),children:(0,r.jsx)(i.Input.TextArea,{rows:25,title:"enter your facts here",onChange:e=>{l(e.target.value),s(e.target.value,(0,a.safeParse)(e.target.value))},value:t})})},s.RuleEditorAntd=({facts:e={},rule:s=["","eq",""],onUpdate:t=((e,s)=>{}),index:c=0,depth:d=0})=>{const[p,f]=(0,n.useState)("middle"),[h,x]=(0,n.useState)(Object.entries((0,l.flattenKeys)(e))),[g,y]=(0,n.useState)(s),[v,j,m]=g;(0,n.useEffect)((()=>{x(Object.entries((0,l.flattenKeys)(e)))}),[JSON.stringify(e)]),(0,n.useEffect)((()=>{t([v,j,m],c)}),[v,j,m]);const C=`${c}-${d}`,b=`value-${C}`,E=`term-${C}`,S=(0,l.processRuleOrGroup)(e,g);return(0,r.jsxs)(i.Space,{direction:"horizontal",children:[(0,r.jsx)(i.Tooltip,{title:(S.pass?"Rule Passed":"Rule Failed")+" with provided facts",children:(0,r.jsx)(i.Tag,{icon:(0,r.jsx)(o.CheckCircleOutlined,{}),color:S.pass?"green":"red"})}),(0,r.jsx)("div",{children:(0,r.jsx)(i.AutoComplete,{style:{width:"200px"},size:p,id:E,autoFocus:u===E,options:h.map((([e])=>({value:e}))),value:v,onChange:e=>{u=E,y([e.toString(),j,m])}})},"rule-fact"),(0,r.jsx)("div",{children:(0,r.jsx)(i.Tooltip,{title:`${v} ${a.opMap[j]} ${m}`,children:(0,r.jsx)(i.Select,{style:{width:"145px"},size:p,value:j,onChange:e=>y([v,e,m]),options:l.operators.map((e=>({label:a.opMap[e],value:e})))})})},"rule-op"),(0,r.jsx)("div",{children:(0,r.jsx)(i.AutoComplete,{style:{width:"200px"},size:p,id:b,autoFocus:u===b,options:h.map((([,e])=>({value:e.toString()}))),value:m,onChange:e=>{u=b,y([v,j,e])}})},"rule-term")]},C)};const c=({facts:e={},rules:t={},onChange:a=(e=>{}),depth:u=0,index:d=0,showFactsEditor:p=!0,extra:f=(()=>null),FactsEditor:h=s.FactsEditorAntd})=>{const[x,g]=(0,n.useState)("middle"),[y,v]=(0,n.useState)(e),[j,m]=(0,n.useState)(t.all?"all":"any"),[C,b]=(0,n.useState)(t),[E,S]=(0,n.useState)([...C.all||C.any]),[R,O]=(0,n.useState)({}),N=["","eq",""],$={all:[N]},F=(e,s)=>{E[s]=e,a({[j]:[...E]},s,d)},w=e=>{E.splice(e,1),b({[j]:[...E]}),S([...E]),a({[j]:[...E]},e,d)};(0,n.useEffect)((()=>{(0,l.processVerbose)(e,C),a(C,0,d)}),[JSON.stringify(C)]),(0,n.useEffect)((()=>{b({[j]:[...E]})}),[JSON.stringify(E)]),(0,n.useEffect)((()=>{b({[j]:[...E]})}),[j]);const A=(0,l.processRuleOrGroup)(e,C);return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[p&&0===u&&0===d&&(0,r.jsx)(h,{object:y,onChange:(e,s)=>{s&&v(s)}}),(0,r.jsx)(i.Card,{style:{marginTop:"4px"},hoverable:!0,title:0===u&&0===d&&(0,r.jsxs)(i.Space,{children:[(0,r.jsxs)("span",{style:{color:A?"green":"darkred"},children:["Rule is ",A?"valid":"invalid","."]}),(0,r.jsxs)("span",{style:{color:A?"green":"darkred"},children:["Rule is ",A?.pass?"passing":"failing","."]})]}),children:(0,r.jsxs)("div",{style:{border:"2px dotted #ccc",padding:"4px"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(i.Select,{size:x,value:j,options:["all","any"].map((e=>({label:e,value:e}))),onChange:e=>m(e),style:{width:"70px"}}),(0,r.jsx)(i.Button,{size:x,icon:(0,r.jsx)(o.PlusCircleOutlined,{}),title:"add a group",onClick:()=>((e=null)=>{null===e?E.push($):E.splice(e,0,$),S([...E]),a({[j]:[...E]},e,d)})()}),f&&f()]}),(0,r.jsx)("div",{children:E.map(((e,t)=>Array.isArray(e)?(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,r.jsx)(s.RuleEditorAntd,{onUpdate:F,rule:e,facts:y,index:t,depth:u},`${JSON.stringify(e)}-${t}-${u}`),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"nowrap"},children:[(0,r.jsx)(i.Button,{size:x,icon:(0,r.jsx)(o.PlusCircleOutlined,{}),title:"add a rule",onClick:()=>((e=null)=>{null===e?E.push(N):E.splice(e,0,N),S([...E]),a({[j]:[...E]},e,d)})(t+1)}),t>0&&(0,r.jsx)(i.Button,{size:x,icon:(0,r.jsx)(o.MinusCircleOutlined,{}),title:"remove rule",onClick:()=>w(t)})]})]}):(0,r.jsx)(c,{extra:t>0?()=>(0,r.jsx)(i.Button,{size:x,title:"remove group",onClick:()=>w(t),icon:(0,r.jsx)(o.MinusCircleOutlined,{})}):null,rules:e,facts:y,index:t,depth:u+1,onChange:(e,s,r)=>{E[t]=e,a({[j]:[...E]},s,r)}},`${JSON.stringify(e)}-${t}-${u}`)))})]})})]},`group-edit-${d}-${u}`)};s.ICRulesEditorAntd=({rules:e={},facts:t={},onChange:l=(e=>null),options:a={showFactsEditor:!0,factsEditor:s.FactsEditorAntd}})=>{const[i,o]=(0,n.useState)(e),{showFactsEditor:u}=a;return(0,r.jsx)(c,{rules:i,facts:t,onChange:e=>{l(e),o({...e})},showFactsEditor:u,FactsEditor:a.factsEditor})},s.default=s.ICRulesEditorAntd},783:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.opMap=s.safeParse=s.flattenKeys=s.ICRulesEditor=s.ICRulesEditorAntd=void 0;var r=t(69);Object.defineProperty(s,"ICRulesEditorAntd",{enumerable:!0,get:function(){return r.ICRulesEditorAntd}});const l=t(780);Object.defineProperty(s,"ICRulesEditor",{enumerable:!0,get:function(){return l.ICRulesEditor}}),s.default=l.ICRulesEditor,s.flattenKeys=(e,t="")=>{let r={};for(const l in e)"object"==typeof e[l]?r={...r,...(0,s.flattenKeys)(e[l],`${t}${l}.`)}:r[`${t}${l}`]=e[l];return r},s.safeParse=(e,s=!1)=>{try{return JSON.parse(e)}catch(e){return s&&console.error(e),!1}},s.opMap={eq:"equals",neq:"not equals",gt:"> greater than",lt:"< less than",lte:"<= less or equal",gte:">= greater or equal",has:"contains",nhas:"not contains",in:"in term",nit:"not in term"}},741:e=>{self,e.exports=(()=>{"use strict";var e={};return((e,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.validateRule=s.processRules=s.processVerbose=s.processGroup=s.flattenKeys=s.processRuleOrGroup=s.processResult=s.verbosePlugin=s.isGroup=s.operators=void 0,s.operators=["eq","neq","gt","lt","gte","lte","has","nhas","in","nit"];const t=".";function r(e={}){const{all:s,any:t}=e;return!(!s&&!t)}function l(e={},l,i=[]){if(r(l))return a(e,l,i);const[o,u,c]=l;if(null==o||!u)throw new Error(`Invalid Rule\n${JSON.stringify(l,null,2)}`);const d={pass:!1},p=e&&e[o],f=typeof p,h=("object"==typeof c&&r(c),Array.isArray(c)),x={value:p,type:f,queryFields:null};if(o.indexOf(t)>0){const s=n(e)[o],t=typeof s;s&&(x.value=s,x.type=Array.isArray(s)?"array":t)}const g="bigint"===x.type||"number"===x.type?parseInt(c,10):c,y=x.value;if("has"===u||"nhas"===u){if(["number","bigint","symbol","undefined"].includes(typeof y))return{pass:!1};const e=y.includes(c);d.pass="nhas"===u?!e:e}return"in"!==u&&"nit"!==u||(h||["string","object"].includes(typeof c))&&(d.pass=c.includes(y)),"eq"===u&&(d.pass=y===g),"neq"===u&&(d.pass=y!==g),"gt"===u&&(d.pass=y>g),"gte"===u&&(d.pass=y>=g),"lt"===u&&(d.pass=y<g),"lte"===u&&(d.pass=y<=g),(0,s.processResult)({...d,rule:l,facts:e,plugins:i})}function n(e,s="",t="."){return Object.entries(e).reduce(((e,[r,l])=>"object"!=typeof l||Array.isArray(l)?{...e,[`${s}${r}`]:l}:{...e,...n(l,`${s}${r}${t}`)}),{})}function a(e={},t={},r=[]){const{all:n,any:a}=t,i=s=>l(e,s,r);if(n){const l=n.map(i),a=l.every((e=>e.pass));return(0,s.processResult)({pass:a,rule:t,facts:e,plugins:r,group:{all:l,pass:a}})}if(a){const l=a.map(i),n=l.some((e=>e.pass));return(0,s.processResult)({pass:n,rule:t,facts:e,plugins:r,group:{any:l,pass:n}})}throw new Error(`Invalid RuleGroup\n${JSON.stringify(t,null,2)}`)}s.isGroup=r,s.verbosePlugin=({pass:e,rule:s,group:t})=>({pass:e,rule:s,group:t}),s.processResult=({pass:e,facts:s,rule:t,group:r,plugins:l=[]})=>l.reduce(((l,n)=>({...l,...n({pass:e,facts:s,rule:t,group:r})||{}})),{pass:e}),s.processRuleOrGroup=l,s.flattenKeys=n,s.processGroup=a,s.processVerbose=(e={},t,r=[])=>a(e,t,[s.verbosePlugin,...r]),s.processRules=a,s.validateRule=function e(t={}){const r=!1;if(!t)return{isValid:r,message:"No Rule Group Found"};const{all:l,any:n}=t;return l||n?(t=>{if(0===t.length)return{isValid:r,message:"No Rule Group Found"};for(let l=0;l<t.length;l++){const n=t[l];if(n?.all||n?.any)return e(n);const a=n;if(!Array.isArray(a)||a.length<2)return{isValid:r,message:"No Rule Group Found"};const[i,o]=a;if(!i||!o)return{isValid:r,message:"Invalid Rule"};if(!s.operators.includes(o))return{isValid:r,message:"Invalid Operator"}}return{isValid:!0}})(l||n):{isValid:r,message:"No Quantifiers (all|any) Found"}}})(0,e),e})()},375:s=>{"use strict";s.exports=e},59:e=>{"use strict";e.exports=s},155:e=>{"use strict";e.exports=t}},l={};function n(e){var s=l[e];if(void 0!==s)return s.exports;var t=l[e]={exports:{}};return r[e](t,t.exports,n),t.exports}return n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(783)})()));