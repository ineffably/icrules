/*! For license information please see index.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@ant-design/icons"),require("antd"),require("react")):"function"==typeof define&&define.amd?define(["@ant-design/icons","antd","react"],t):"object"==typeof exports?exports.editor=t(require("@ant-design/icons"),require("antd"),require("react")):e.editor=t(e["@ant-design/icons"],e.antd,e.react)}(self,((e,t,s)=>(()=>{var r={961:(e,t,s)=>{"use strict";s.r(t)},335:(e,t,s)=>{"use strict";var r=s(155),l=Symbol.for("react.element"),n=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,s){var r,n={},u=null,c=null;for(r in void 0!==s&&(u=""+s),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,r)&&!o.hasOwnProperty(r)&&(n[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===n[r]&&(n[r]=t[r]);return{$$typeof:l,type:e,key:u,ref:c,props:n,_owner:i.current}}t.Fragment=n,t.jsx=u,t.jsxs=u},85:(e,t,s)=>{"use strict";e.exports=s(335)},780:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FactsEditor=t.ICRulesEditor=void 0;const r=s(85),l=s(155),n=s(783),a=s(741);s(961);let i=null;const o=({facts:e={},rule:t=["","eq",""],onUpdate:s=((e,t)=>{}),index:o=0,depth:u=0})=>{const[c]=(0,l.useState)(Object.keys(e)),[d,p]=(0,l.useState)(t),[f,h,x]=d,g=`${o}-${u}`,v=`${c}-${g}`;(0,l.useEffect)((()=>{s([f,h,x],o)}),[f,h,x]);const y=`value-${g}`,j=`term-${g}`,m=(0,a.processRuleOrGroup)(e,d);return(0,r.jsxs)("div",{className:"rule-editor",children:[(0,r.jsx)("div",{className:"rule-result",children:m.pass?(0,r.jsx)("span",{className:"pass",children:"✓"}):(0,r.jsx)("span",{className:"fail",children:"✕"})}),(0,r.jsxs)("div",{className:"rule-entry rule-fact",children:[(0,r.jsx)("input",{id:j,autoComplete:"on",autoFocus:i===j,type:"text",list:v,value:f,onChange:e=>{i=e.target.id,p([e.target.value,h,x])}}),(0,r.jsx)("datalist",{id:v,children:c.map((e=>(0,r.jsx)("option",{value:e})))})]},"rule-fact"),(0,r.jsx)("div",{className:"rule-entry rule-op",children:(0,r.jsx)("select",{value:h,onChange:e=>p([f,e.target.value,x]),children:a.internalOperatorValues.map((e=>(0,r.jsx)("option",{value:e,children:n.opMap[e]})))})},"rule-op"),(0,r.jsx)("div",{className:"rule-entry rule-term",children:(0,r.jsx)("input",{type:"text",id:y,value:x,autoFocus:i===y,onChange:e=>{i=e.target.id,p([f,h,e.target.value])}})},"rule-term")]},g)},u=({facts:e={},rules:s={},onChange:n=(e=>{}),depth:i=0,index:c=0,showFactsEditor:d=!0})=>{const[p,f]=(0,l.useState)(e),[h,x]=(0,l.useState)(s.all?"all":"any"),[g,v]=(0,l.useState)(s),[y,j]=(0,l.useState)([...g.all||g.any]),[m,C]=(0,l.useState)({}),O=["","eq",""],b={all:[O]},E=(e,t)=>{y[t]=e,n({[h]:[...y]},t,c)},S=e=>{y.splice(e,1),v({[h]:[...y]}),j([...y]),n({[h]:[...y]},e,c)};(0,l.useEffect)((()=>{(0,a.processVerbose)(e,g),n(g,0,c)}),[JSON.stringify(g)]),(0,l.useEffect)((()=>{v({[h]:[...y]})}),[JSON.stringify(y)]),(0,l.useEffect)((()=>{v({[h]:[...y]})}),[h]);const R=(0,a.processRuleOrGroup)(e,g);return(0,r.jsxs)("div",{className:"rule-group-editor",children:[d&&0===i&&0===c&&(0,r.jsx)("div",{children:(0,r.jsx)(t.FactsEditor,{object:p,onChange:(e,t)=>{t&&f(e)}})}),(0,r.jsxs)("div",{children:[0===i&&0===c&&(0,r.jsxs)("div",{className:"facts-status",children:[(0,r.jsxs)("span",{style:{color:R?"green":"darkred"},children:["Rule is ",R?"valid":"invalid",". "]}),(0,r.jsxs)("span",{style:{color:R?.pass?"green":"darkred"},children:["Rule is ",R?.pass?"passing":"failing",". "]})]}),(0,r.jsxs)("div",{className:"rules",children:[(0,r.jsxs)("div",{className:"rule-entry quantifier",children:[(0,r.jsx)("div",{className:"check-mark",children:R?.pass?(0,r.jsx)("span",{className:"pass",children:"☑"}):(0,r.jsx)("span",{className:"fail",children:"☒"})}),(0,r.jsx)("select",{value:h,onChange:e=>x(e.target.value),children:["all","any"].map((e=>(0,r.jsx)("option",{value:e,children:e})))}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{className:"add-group",title:"add a group",onClick:()=>((e=null)=>{null===e?y.push(b):y.splice(e,0,b),j([...y]),n({[h]:[...y]},e,c)})(),children:"➕"})})]}),(0,r.jsx)("div",{className:"rule-list",children:y.map(((t,s)=>Array.isArray(t)?(0,r.jsxs)("div",{className:"editor-wrap",children:[(0,r.jsx)(o,{onUpdate:E,rule:t,facts:p,index:s,depth:i},`${JSON.stringify(t)}-${s}-${i}`),(0,r.jsxs)("div",{className:"addrule",children:[(0,r.jsx)("button",{title:"add a rule",onClick:()=>((e=null)=>{null===e?y.push(O):y.splice(e,0,O),j([...y]),n({[h]:[...y]},e,c)})(s+1),children:"+"}),s>0&&(0,r.jsx)("button",{title:"remove rule",onClick:()=>S(s),children:"-"})]})]}):(0,r.jsxs)("div",{className:"editor-wrap",children:[(0,r.jsx)(u,{rules:t,facts:e,index:s,depth:i+1,onChange:(e,t,r)=>{y[s]=e,n({[h]:[...y]},t,r)}},`${JSON.stringify(t)}-${s}-${i}`),(0,r.jsx)("div",{className:"remove-group-cell",children:s>0&&(0,r.jsx)("button",{className:"remove-group",title:"remove group",onClick:()=>S(s),children:"➖"})})]})))})]})]})]},`group-edit-${c}-${i}`)};t.ICRulesEditor=({rules:e={},facts:t={},onChange:s=(e=>null),options:n={showFactsEditor:!0}})=>{const[a,i]=(0,l.useState)(e),{showFactsEditor:o}=n;return(0,r.jsx)(u,{rules:a,facts:t,onChange:e=>{s(e),i({...e})},showFactsEditor:o})},t.FactsEditor=({object:e,onChange:t=(()=>null)})=>{const[s,a]=(0,l.useState)(JSON.stringify(e,null,2)),i=(0,n.safeParse)(s);return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"facts-status",style:{color:i?"green":"darkred"},children:["Facts are ",i?"valid":"invalid"]}),(0,r.jsx)("textarea",{title:"enter your facts here",onChange:e=>{a(e.target.value),t(e.target.value,!1!==i)},style:{width:"300px",height:"300px"},value:s})]})},t.default=t.ICRulesEditor},69:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICRulesEditorAntd=t.RuleEditorAntd=t.FactsEditorAntd=void 0;const r=s(85),l=s(741),n=s(155),a=s(783),i=s(59),o=s(375);s(961);let u=null;t.FactsEditorAntd=({object:e,onChange:t=(()=>null)})=>{const[s,l]=(0,n.useState)(JSON.stringify(e,null,2)),o=(0,a.safeParse)(s);return(0,r.jsx)(i.Card,{style:{width:"350px",margin:"4px"},hoverable:!0,title:(0,r.jsxs)("span",{style:{color:o?"green":"darkred"},children:["Facts are ",o?"valid":"invalid","."]}),children:(0,r.jsx)(i.Input.TextArea,{rows:25,title:"enter your facts here",onChange:e=>{l(e.target.value),t(e.target.value,(0,a.safeParse)(e.target.value))},value:s})})},t.RuleEditorAntd=({facts:e={},rule:t=["","eq",""],onUpdate:s=((e,t)=>{}),index:c=0,depth:d=0})=>{const[p,f]=(0,n.useState)("middle"),[h,x]=(0,n.useState)(Object.entries((0,l.flattenKeys)(e))),[g,v]=(0,n.useState)(t),[y,j,m]=g;(0,n.useEffect)((()=>{x(Object.entries((0,l.flattenKeys)(e)))}),[JSON.stringify(e)]),(0,n.useEffect)((()=>{s([y,j,m],c)}),[y,j,m]);const C=`${c}-${d}`,O=`value-${C}`,b=`term-${C}`,E=(0,l.processRuleOrGroup)(e,g);return(0,r.jsxs)(i.Space,{direction:"horizontal",children:[(0,r.jsx)(i.Tooltip,{title:(E.pass?"Rule Passed":"Rule Failed")+" with provided facts",children:(0,r.jsx)(i.Tag,{icon:(0,r.jsx)(o.CheckCircleOutlined,{}),color:E.pass?"green":"red"})}),(0,r.jsx)("div",{children:(0,r.jsx)(i.AutoComplete,{style:{width:"200px"},size:p,id:b,autoFocus:u===b,options:h.map((([e])=>({value:e}))),value:y,onChange:e=>{u=b,v([e.toString(),j,m])}})},"rule-fact"),(0,r.jsx)("div",{children:(0,r.jsx)(i.Tooltip,{title:`${y} ${a.opMap[j]} ${m}`,children:(0,r.jsx)(i.Select,{style:{width:"145px"},size:p,value:j,onChange:e=>v([y,e,m]),options:l.internalOperatorValues.map((e=>({label:a.opMap[e],value:e})))})})},"rule-op"),(0,r.jsx)("div",{children:(0,r.jsx)(i.AutoComplete,{style:{width:"200px"},size:p,id:O,autoFocus:u===O,options:h.map((([,e])=>({value:e.toString()}))),value:m,onChange:e=>{u=O,v([y,j,e])}})},"rule-term")]},C)};const c=({facts:e={},rules:s={},onChange:a=(e=>{}),depth:u=0,index:d=0,showFactsEditor:p=!0,extra:f=(()=>null),FactsEditor:h=t.FactsEditorAntd})=>{const[x,g]=(0,n.useState)("middle"),[v,y]=(0,n.useState)(e),[j,m]=(0,n.useState)(s.all?"all":"any"),[C,O]=(0,n.useState)(s),[b,E]=(0,n.useState)([...C.all||C.any]),[S,R]=(0,n.useState)({}),N=["","eq",""],$={all:[N]},F=(e,t)=>{b[t]=e,a({[j]:[...b]},t,d)},w=e=>{b.splice(e,1),O({[j]:[...b]}),E([...b]),a({[j]:[...b]},e,d)};(0,n.useEffect)((()=>{(0,l.processVerbose)(e,C),a(C,0,d)}),[JSON.stringify(C)]),(0,n.useEffect)((()=>{O({[j]:[...b]})}),[JSON.stringify(b)]),(0,n.useEffect)((()=>{O({[j]:[...b]})}),[j]);const A=(0,l.processRuleOrGroup)(e,C);return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[p&&0===u&&0===d&&(0,r.jsx)(h,{object:v,onChange:(e,t)=>{t&&y(t)}}),(0,r.jsx)(i.Card,{style:{marginTop:"4px"},hoverable:!0,title:0===u&&0===d&&(0,r.jsxs)(i.Space,{children:[(0,r.jsxs)("span",{style:{color:A?"green":"darkred"},children:["Rule is ",A?"valid":"invalid","."]}),(0,r.jsxs)("span",{style:{color:A?"green":"darkred"},children:["Rule is ",A?.pass?"passing":"failing","."]})]}),children:(0,r.jsxs)("div",{style:{border:"2px dotted #ccc",padding:"4px"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(i.Select,{size:x,value:j,options:["all","any"].map((e=>({label:e,value:e}))),onChange:e=>m(e),style:{width:"70px"}}),(0,r.jsx)(i.Button,{size:x,icon:(0,r.jsx)(o.PlusCircleOutlined,{}),title:"add a group",onClick:()=>((e=null)=>{null===e?b.push($):b.splice(e,0,$),E([...b]),a({[j]:[...b]},e,d)})()}),f&&f()]}),(0,r.jsx)("div",{children:b.map(((e,s)=>Array.isArray(e)?(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,r.jsx)(t.RuleEditorAntd,{onUpdate:F,rule:e,facts:v,index:s,depth:u},`${JSON.stringify(e)}-${s}-${u}`),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"nowrap"},children:[(0,r.jsx)(i.Button,{size:x,icon:(0,r.jsx)(o.PlusCircleOutlined,{}),title:"add a rule",onClick:()=>((e=null)=>{null===e?b.push(N):b.splice(e,0,N),E([...b]),a({[j]:[...b]},e,d)})(s+1)}),s>0&&(0,r.jsx)(i.Button,{size:x,icon:(0,r.jsx)(o.MinusCircleOutlined,{}),title:"remove rule",onClick:()=>w(s)})]})]}):(0,r.jsx)(c,{extra:s>0?()=>(0,r.jsx)(i.Button,{size:x,title:"remove group",onClick:()=>w(s),icon:(0,r.jsx)(o.MinusCircleOutlined,{})}):null,rules:e,facts:v,index:s,depth:u+1,onChange:(e,t,r)=>{b[s]=e,a({[j]:[...b]},t,r)}},`${JSON.stringify(e)}-${s}-${u}`)))})]})})]},`group-edit-${d}-${u}`)};t.ICRulesEditorAntd=({rules:e={},facts:s={},onChange:l=(e=>null),options:a={showFactsEditor:!0,factsEditor:t.FactsEditorAntd}})=>{const[i,o]=(0,n.useState)(e),{showFactsEditor:u}=a;return(0,r.jsx)(c,{rules:i,facts:s,onChange:e=>{l(e),o({...e})},showFactsEditor:u,FactsEditor:a.factsEditor})},t.default=t.ICRulesEditorAntd},783:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.opMap=t.safeParse=t.flattenKeys=t.ICRulesEditor=t.ICRulesEditorAntd=void 0;var r=s(69);Object.defineProperty(t,"ICRulesEditorAntd",{enumerable:!0,get:function(){return r.ICRulesEditorAntd}});const l=s(780);Object.defineProperty(t,"ICRulesEditor",{enumerable:!0,get:function(){return l.ICRulesEditor}}),t.default=l.ICRulesEditor,t.flattenKeys=(e,s="")=>{let r={};for(const l in e)"object"==typeof e[l]?r={...r,...(0,t.flattenKeys)(e[l],`${s}${l}.`)}:r[`${s}${l}`]=e[l];return r},t.safeParse=(e,t=!1)=>{try{return JSON.parse(e)}catch(e){return t&&console.error(e),!1}},t.opMap={eq:"equals",neq:"not equals",gt:"> greater than",lt:"< less than",lte:"<= less or equal",gte:">= greater or equal",has:"contains",nhas:"not contains",in:"in term",nit:"not in term"}},741:e=>{self,e.exports=(()=>{"use strict";var e={};return((e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processRules=t.validateRule=t.processVerbose=t.verbosePlugin=t.processGroup=t.processRuleOrGroup=t.internalOperators=t.processResult=t.flattenKeys=t.isGroup=t.internalOperatorValues=void 0,t.internalOperatorValues=["eq","neq","gt","lt","gte","lte","has","nhas","in","nit"];const s=".";function r(e={}){const{all:t,any:s}=e;return!(!t&&!s)}function l(e,t="",s="."){return Object.entries(e).reduce(((e,[r,n])=>"object"!=typeof n||Array.isArray(n)?{...e,[`${t}${r}`]:n}:{...e,...l(n,`${t}${r}${s}`)}),{})}t.isGroup=r,t.flattenKeys=l,t.processResult=({pass:e,facts:t,rule:s,group:r,plugins:l=[]})=>l.reduce(((l,n)=>({...l,...n({pass:e,facts:t,rule:s,group:r})||{}})),{pass:e});const n=e=>({value:t,term:s})=>{if(Array.isArray(s)||["string","object"].includes(typeof s)){const r=s.includes(t);return"in"===e?r:!r}return!1},a=e=>({value:t,term:s})=>{if(["number","bigint","symbol","undefined"].includes(typeof t))return!1;const r=t.includes(s);return"has"===e?r:!r};function i(e={},n,a={}){const{plugins:i=[],operators:u={}}=a;if(r(n))return o(e,n,{plugins:i});const[c,d,p]=n;if(null==c||!d)throw new Error(`Invalid Rule\n${JSON.stringify(n,null,2)}`);const f={pass:!1},h=e?.[c],x=typeof h,g=("object"==typeof p&&r(p),{value:h,type:x,queryFields:null});if(c.indexOf(s)>0){const t=l(e)[c],s=typeof t;t&&(g.value=t,g.type=Array.isArray(t)?"array":s)}const v="bigint"===g.type||"number"===g.type?parseInt(p,10):p,y=g.value;return t.internalOperators[d]&&(f.pass=t.internalOperators[d]({value:y,term:v})),u[d]&&(f.pass=u[d]({value:y,term:v})),(0,t.processResult)({...f,rule:n,facts:e,plugins:i})}function o(e={},s={},r={}){const{all:l,any:n}=s,{plugins:a=[]}=r,o=t=>i(e,t,r);if(l){const r=l.map(o),n=r.every((e=>e.pass));return(0,t.processResult)({pass:n,rule:s,facts:e,plugins:a,group:{all:r,pass:n}})}if(n){const r=n.map(o),l=r.some((e=>e.pass));return(0,t.processResult)({pass:l,rule:s,facts:e,plugins:a,group:{any:r,pass:l}})}throw new Error(`Invalid RuleGroup\n${JSON.stringify(s,null,2)}`)}t.internalOperators={eq:({value:e,term:t})=>e===t,neq:({value:e,term:t})=>e!==t,gt:({value:e,term:t})=>e>t,gte:({value:e,term:t})=>e>=t,lt:({value:e,term:t})=>e<t,lte:({value:e,term:t})=>e<=t,in:n("in"),nit:n("nit"),has:a("has"),nhas:a("nhas")},t.processRuleOrGroup=i,t.processGroup=o,t.verbosePlugin=({pass:e,rule:t,group:s})=>({pass:e,rule:t,group:s}),t.processVerbose=(e={},s,r=[])=>o(e,s,{plugins:[t.verbosePlugin,...r]}),t.validateRule=function e(s={}){const r=!1;if(!s)return{isValid:r,message:"No Rule Group Found"};const{all:l,any:n}=s;return l||n?(s=>{if(0===s.length)return{isValid:r,message:"No Rule Group Found"};for(let l=0;l<s.length;l++){const n=s[l];if(n?.all||n?.any)return e(n);const a=n;if(!Array.isArray(a)||a.length<2)return{isValid:r,message:"No Rule Group Found"};const[i,o]=a;if(!i||!o)return{isValid:r,message:"Invalid Rule"};if(!t.internalOperatorValues.includes(o))return{isValid:r,message:"Invalid Operator"}}return{isValid:!0}})(l||n):{isValid:r,message:"No Quantifiers (all|any) Found"}},t.processRules=o,t.default=t.processRules})(0,e),e})()},375:t=>{"use strict";t.exports=e},59:e=>{"use strict";e.exports=t},155:e=>{"use strict";e.exports=s}},l={};function n(e){var t=l[e];if(void 0!==t)return t.exports;var s=l[e]={exports:{}};return r[e](s,s.exports,n),s.exports}return n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(783)})()));